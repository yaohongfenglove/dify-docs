# 追加機能

ワークフローとチャットフローアプリは、ユーザーのインタラクション体験を向上させるためにさまざまな機能を追加しています。たとえば、ファイルのアップロード機能を追加したり、LLMアプリに自己紹介セクションを組み込んだり、ウェルカムメッセージを活用することで、ユーザはより充実したインタラクションを楽しむことができます。

アプリの右上隅にある**「機能」**ボタンをクリックすると、追加機能を利用できます。

### ワークフロー

ワークフロータイプのアプリは、**「画像のアップロード」**機能のみをサポートしています。この機能を有効にすると、ワークフローアプリの使用ページに画像のアップロードエントリが表示されます。

{% @arcade/embed flowId="a0tbwuEIT5I3y5RdHsJp" url="https://app.arcade.software/share/a0tbwuEIT5I3y5RdHsJp" %}

**使用方法：**

**ユーザー向け：** 画像のアップロード機能が有効化されたアプリの使用ページには、アップロードボタンが表示されます。このボタンをクリックするか、ファイルのリンクを貼り付けることで画像をアップロードし、LLMから画像に関する回答を受け取ることができます。

**開発者向け：** 画像のアップロード機能を有効化すると、使用者がアップロードした画像ファイルは`sys.files`変数に保存されます。次に、LLMノードを追加し、視覚能力を持つ大規模モデルを選択してVISION機能を有効化し、`sys.files`変数を選択することで、LLMがその画像ファイルを読み取れるようになります。

最後に、ENDノードでLLMノードの出力変数を選択し、設定を完了させます。

<figure><img src="../../../zh_CN/.gitbook/assets/image (7).png" alt=""><figcaption><p>視覚分析能力の有効化</p></figcaption></figure>

### チャットフロー

チャットフロータイプのアプリは、以下の機能をサポートしています：

*   **冒頭の対話**

    AIが自動的に一文を送信し、歓迎メッセージやAIの自己紹介などで使用者との距離を縮めます。
*   **次の質問の提案**

    対話が完了した後に、自動的に次の質問の提案を追加することで、対話のトピックの深さと頻度を向上させます。
*   **テキストから音声への変換**

    テキストボックスに音声再生ボタンを追加し、TTSサービス（[モデルプロバイダ](../../getting-started/readme/model-providers.md)が提供）を利用してテキストを読み上げます。
*   **ファイルのアップロード**

    ドキュメント、画像、音声、ビデオ、その他のファイル形式をサポートしています。この機能を有効にすると、アプリの使用者は対話の過程でいつでもファイルをアップロードおよび更新できます。最大10個のファイルを同時にアップロードでき、各ファイルのサイズ上限は15MBです。

    <figure><img src="../../../zh_CN/.gitbook/assets/image (8).png" alt=""><figcaption><p>ファイルのアップロード機能</p></figcaption></figure>

*   **引用と帰属**

    [「知識検索」](node/knowledge-retrieval.md)ノードと組み合わせることで、LLMが応答した際の参照元ドキュメントと帰属部分を表示します。
*   **コンテンツの審査**

    審査APIを利用して適切な単語リストを維持し、LLMが安全なコンテンツを応答および出力できるようにします。詳細については[適切なコンテンツの審査](../application-orchestrate/app-toolkits/moderation-tool.md)を参照してください。

**使用方法：**

**ファイルのアップロード**機能以外のチャットフローアプリ内の機能は比較的簡単に使用できます。有効化すると、直感的にアプリのインタラクションページで利用可能です。

このセクションでは、主に**ファイルのアップロード**機能の具体的な使用方法に焦点を当てます：

**ユーザー向け：** ファイルのアップロード機能が有効化されたチャットフローアプリでは、対話ボックスの右側に「クリップ」アイコンが表示されます。このアイコンをクリックすることでファイルをアップロードし、LLMと対話できます。

<figure><img src="../../../zh_CN/.gitbook/assets/image (9).png" alt=""><figcaption><p>ファイルのアップロードの使用</p></figcaption></figure>

**アプリ開発者向け：**

ファイルアップロード機能を有効にすると、ユーザーがアップロードしたファイルは `sys.files` 変数に保存されます。ユーザーが対話中に新しいファイルをアップロードすると、この変数内のファイルは上書きされます。

アップロードされるファイルの種類に応じて、アプリケーションの設定方法が異なります。

* **ドキュメントファイル**

LLMは直接ドキュメントファイルを読み取る機能を持っていないため、[ドキュメント抽出機](node/doc-extractor.md) ノードを使用して `sys.files` 変数内のファイルを前処理する必要があります。設定手順は以下の通りです：

1. Features 機能を有効にし、ファイルタイプで "ドキュメント" のみを選択します。
2. [ドキュメント抽出機](node/doc-extractor.md) ノードの入力変数で `sys.files` 変数を選択します。
3. LLM ノードを追加し、システムプロンプトでドキュメント抽出機ノードの出力変数を選択します。
4. 最後に "直接返信" ノードを追加し、LLM ノードの出力変数を記入します。

この方法で構築された チャットフロー アプリは、アップロードされたファイルの内容を記憶しません。アプリの使用者は毎回チャットボックスでドキュメントファイルをアップロードする必要があります。アプリがアップロードされたファイルを記憶する場合は、[「ファイルアップロード：開始ノードに変数を追加」](file-upload.md#fang-fa-er-zai-tian-jia-wen-jian-bian-liang)を参照してください。

* **画像ファイル**

一部のLLMは画像から情報を直接取得できるため、画像を処理するための追加ノードは不要です。

設定手順は以下の通りです：

1. Features 機能を有効にし、ファイルタイプで "画像" のみを選択します。
2. LLM ノードを追加し、VISION 機能を有効にして `sys.files` 変数を選択します。
3. 最後に "直接返信" ノードを追加し、LLM ノードの出力変数を記入します。

* **複合ファイルタイプ**

ドキュメントファイルと画像ファイルを同時に処理したい場合は、[リスト操作](node/list-operator.md) ノードを使用して `sys.files` 変数内のファイルを前処理し、より詳細な変数を抽出して対応する処理ノードに送信する必要があります。設定手順は以下の通りです：

1. Features 機能を有効にし、ファイルタイプで "画像" および "ドキュメントファイル" を選択します。
2. 二つのリスト操作ノードを追加し、"フィルタリング" 条件で画像とドキュメント変数を抽出します。
3. ドキュメントファイル変数を抽出し、"ドキュメント抽出機" ノードに渡し、画像ファイル変数を抽出し、LLM ノードに渡します。
4. 最後に "直接返信" ノードを追加し、LLM ノードの出力変数を記入します。

アプリ使用者が文書ファイルと画像を同時にアップロードした場合、文書ファイルは自動的に文書抽出機ノードに送られ、画像ファイルはLLMノードに送られて、ファイルを共同で処理することができます。

* **音声・動画ファイル**

LLMは音声・動画ファイルを直接読み取る機能をサポートしておらず、Difyプラットフォームにも関連するファイル処理ツールは組み込まれていません。アプリ開発者は[外部データツール](../extension/api-based-extension/external-data-tool.md)を参照して、ファイル情報を自分で処理することができます。

### よくある質問

**Dify Cloudでは、チャットボックスでアプリ使用者がアップロードしたファイルはどれくらい保存されますか？**

永続的に保存されます。